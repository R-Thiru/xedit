<div class="relative flex flex-col  max-w-full w-full   lg:min-w-240" cdkDrag cdkDragRootElement=".cdk-overlay-pane">
    <!-- Header -->
    <div class="flex flex-0 items-center justify-between h-12 px-4 bg-primary text-black border-b cursor-move"
        cdkDragHandle>
        <div class="text-lg font-medium">Reference</div>

        <button mat-icon-button mat-dialog-close [tabIndex]="-1">
            <mat-icon class="text-current" [svgIcon]="'heroicons_outline:x'"></mat-icon>
        </button>
    </div>

    <!-- Content -->
    <form class="h-full m-4 space-y-3" [formGroup]="referenceForm">
        <mat-accordion>
            <mat-expansion-panel>
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        Show Details
                    </mat-panel-title>
                </mat-expansion-panel-header>
                <mat-form-field appearance="fill">
                    <mat-label>First name</mat-label>
                    <input matInput>
                </mat-form-field>
            </mat-expansion-panel>
        </mat-accordion>
        <!-- Group and SubGroup -->
        <div class="flex  w-full space-x-4">
            <div class="flex space-x-2">
                <mat-checkbox class="mb-2" [color]="'primary'" [formControlName]="'newGroup'">
                    New Group
                </mat-checkbox>
                <mat-checkbox class="mb-2" [color]="'primary'" [formControlName]="'newSubGroup'">
                    New SubGroup
                </mat-checkbox>
            </div>
            <!-- Group type -->
            <div class="space-x-2 flex ">
                <ng-container *ngIf="referenceForm.get('newGroup').value || referenceForm.get('newSubGroup').value">
                    <mat-form-field>
                        <mat-label>Group type</mat-label>
                        <mat-select [formControlName]="'groupType'">
                            <ng-container>
                                <mat-option [value]="'Reference'">Reference</mat-option>
                                <mat-option [value]="'Biblography'">Biblography</mat-option>
                            </ng-container>
                        </mat-select>
                    </mat-form-field>

                    <mat-form-field *ngIf="referenceForm.get('newGroup').value">
                        <mat-label>Group Title</mat-label>
                        <input [formControlName]="'groupTitle'" placeholder="Group title" matInput autocomplete="off">
                    </mat-form-field>

                    <mat-form-field *ngIf="referenceForm.get('newSubGroup').value">
                        <mat-label>SubGroup Title</mat-label>
                        <input [formControlName]="'subGroupTitle'" placeholder="SubGroup title" matInput
                            autocomplete="off">
                    </mat-form-field>
                </ng-container>

            </div>
        </div>
        <!-- Create reference -->
        <div class="flex ">
            <mat-radio-group class="flex flex-row justify-between w-full" [color]="'primary'" [value]="'new'"
                [formControlName]="'refItems'">
                <mat-radio-button class="mb-2" [value]="'new'">
                    New
                </mat-radio-button>
                <mat-radio-button class="mb-2" [value]="'existing'">
                    Existing
                </mat-radio-button>
                <mat-radio-button [value]="'doi'">
                    Use DOI to retrieve
                </mat-radio-button>
                <mat-radio-button [value]="'pubmed'">
                    Use PubMed ID to retrieve
                </mat-radio-button>
                <mat-radio-button [value]="'text'">
                    Text
                </mat-radio-button>
            </mat-radio-group>
        </div>
        <!-- Reference Group -->
        <div class="flex border-b space-x-2">
            <mat-form-field class="w-1/2">
                <mat-label>Select Reference Group</mat-label>
                <mat-select [formControlName]="'refGroup'">
                    <ng-container>
                        <mat-option [value]="'Reference'">Reference</mat-option>
                        <mat-option [value]="'Biblography'">Biblography</mat-option>
                    </ng-container>
                </mat-select>
            </mat-form-field>
            <mat-form-field class="w-1/2">
                <mat-label>Reference Style</mat-label>
                <mat-select [formControlName]="'refstyle'">
                    <ng-container>
                        <mat-option [value]="'Reference'">Reference</mat-option>
                        <mat-option [value]="'Biblography'">Biblography</mat-option>
                    </ng-container>
                </mat-select>
            </mat-form-field>
        </div>

        <!-- Content of selected Reference -->
        <div class="w-full h-full shadow-xl ">
            <!-- New reference -->
            <div class="flex w-full" *ngIf="referenceForm.get('refItems').value == 'new'">
                <!-- Add button -->
                <div class="flex mt-1 ml-2">
                    <button mat-icon-button (click)="addItem()" class="bg-primary">
                        <mat-icon class="text-current" [svgIcon]="'heroicons_outline:plus'"></mat-icon>
                    </button>
                </div>

                <!-- Stepper -->
                <mat-horizontal-stepper formArrayName="tab" class="w-full" (selectionChange)="getIndexStepper($event)">
                    <mat-step [formGroupName]="i" *ngFor="let data of getTab(referenceForm); let i = index">
                        <ng-template matStepLabel>New Reference</ng-template>
                        <div class="w-full max-h-80 h-full space-y-3 " fuseScrollbar
                            [fuseScrollbarOptions]="{wheelPropagation: true,suppressScrollX: true}">
                            <div class="w-full flex space-x-8">
                                <mat-form-field class="w-1/2">
                                    <mat-label>Ref Type</mat-label>
                                    <mat-select [formControlName]="'reftype'">
                                        <ng-container *ngFor="let ref of referenceTypes">
                                            <mat-option [value]="ref.reference_name">{{ref.reference_name}}</mat-option>
                                        </ng-container>
                                    </mat-select>
                                </mat-form-field>

                                <ng-container *ngIf="changedValue[i] && changedValue[i].reftype != ''">
                                    <mat-checkbox class="flex items-center" [color]="'primary'"
                                        [formControlName]="'collabTitle'">
                                        Collab Title
                                    </mat-checkbox>

                                    <button mat-icon-button (click)="clearItem(i)"
                                        class="flex items-center self-center">
                                        <mat-icon class="text-current" [svgIcon]="'heroicons_outline:minus-sm'">
                                        </mat-icon>
                                    </button>
                                </ng-container>

                            </div>

                            <!-- Authors  -->
                            <ng-container *ngIf="changedValue[i] && changedValue[i].reftype != ''">
                                <div class="w-full space-y-2" formArrayName="authors">
                                    <span class="font-semibold">Authors</span>
                                    <div class="w-full h-full border-2 rounded-lg space-y-2 p-3 drag" cdkDropList
                                        [cdkDropListData]=getauthors(data) (cdkDropListDropped)="drop($event)">
                                        <div class="border flex  space-x-2  items-center" [formGroupName]="j"
                                            *ngFor="let auth of getauthors(data); let j = index" cdkDrag
                                            [cdkDragLockAxis]="'y'">
                                            <!-- Drag and Drop button -->
                                            <button mat-icon-button class="cursor-move" cdkDragHandle>
                                                <mat-icon class="text-current" [svgIcon]="'heroicons_outline:menu'">
                                                </mat-icon>
                                            </button>
                                            <!-- Inline Editor -->
                                            <div class="w-full -mt-4">
                                                <mat-label>Surname</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor"
                                                    (focus)="focus($event)" 
                                                    [config]="editorConfig" [formControlName]="'surname'">
                                                </ckeditor>
                                            </div>
                                            <div class="w-full -mt-4">
                                                <mat-label>Given Name</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor"
                                                    (focus)="focus($event)" 
                                                    [config]="editorConfig" [formControlName]="'givenName'">
                                                </ckeditor>
                                            </div>
                                            <div class="w-full -mt-4">
                                                <mat-label>Prefix</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor"
                                                    (focus)="focus($event)" 
                                                    [config]="editorConfig" [formControlName]="'prefix'">
                                                </ckeditor>
                                            </div>
                                            <div class="w-full -mt-4">
                                                <mat-label>Suffix</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor"
                                                    (focus)="focus($event)" 
                                                    [config]="editorConfig" [formControlName]="'suffix'">
                                                </ckeditor>
                                            </div>
                                            <!-- Add and delete button  -->
                                            <div>
                                                <button mat-icon-button (click)="addAuthorsItem(i, 'authors')">
                                                    <mat-icon class="text-current" [svgIcon]="'heroicons_outline:plus'">
                                                    </mat-icon>
                                                </button>

                                                <button mat-icon-button (click)="clearAuthorsItem(i,j, 'authors')">
                                                    <mat-icon class="text-current"
                                                        [svgIcon]="'heroicons_outline:minus-sm'">
                                                    </mat-icon>
                                                </button>
                                            </div>

                                        </div>
                                    </div>

                                </div>
                                <!-- Checkbox -->
                                <mat-checkbox class="flex items-center" [color]="'primary'"
                                    [formControlName]="'author_et_al'">
                                    et al
                                </mat-checkbox>
                            </ng-container>

                            <!-- Editors -->
                            <ng-container *ngIf="changedValue[i] && changedValue[i].reftype != ''">
                                <ng-container *ngIf="changedValue[i].reftype == 'Book' || changedValue[i].reftype == 'Conference'" >
                                    <div class="w-full space-y-2" formArrayName="editors">
                                        <span class="font-semibold">Editors</span>
                                        <div class="w-full h-full border-2 rounded-lg space-y-2 p-3 drag" cdkDropList
                                            [cdkDropListData]=geteditors(data) (cdkDropListDropped)="drop($event)">
                                            <div class="border flex  space-x-2  items-center" [formGroupName]="j"
                                                *ngFor="let auth of geteditors(data); let j = index" cdkDrag
                                                [cdkDragLockAxis]="'y'">
        
                                                <button mat-icon-button class="cursor-move" cdkDragHandle>
                                                    <mat-icon class="text-current" [svgIcon]="'heroicons_outline:menu'">
                                                    </mat-icon>
                                                </button>
                                                <div class="w-full -mt-4">
                                                    <mat-label>Surname</mat-label>
                                                    <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                         [config]="editorConfig"
                                                        [formControlName]="'surname'">
                                                    </ckeditor>
                                                </div>
                                                <div class="w-full -mt-4">
                                                    <mat-label>Given Name</mat-label>
                                                    <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                         [config]="editorConfig"
                                                        [formControlName]="'givenName'">
                                                    </ckeditor>
                                                </div>
                                                <div class="w-full -mt-4">
                                                    <mat-label>Prefix</mat-label>
                                                    <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                         [config]="editorConfig"
                                                        [formControlName]="'prefix'">
                                                    </ckeditor>
                                                </div>
                                                <div class="w-full -mt-4">
                                                    <mat-label>Suffix</mat-label>
                                                    <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                         [config]="editorConfig"
                                                        [formControlName]="'suffix'">
                                                    </ckeditor>
                                                </div>
                                                <div>
                                                    <button mat-icon-button (click)="addAuthorsItem(i, 'editors')">
                                                        <mat-icon class="text-current" [svgIcon]="'heroicons_outline:plus'">
                                                        </mat-icon>
                                                    </button>
        
                                                    <button mat-icon-button (click)="clearAuthorsItem(i,j, 'editors')">
                                                        <mat-icon class="text-current" [svgIcon]="'heroicons_outline:minus-sm'">
                                                        </mat-icon>
                                                    </button>
                                                </div>
        
                                            </div>
                                        </div>
        
                                    </div>
                                    <mat-checkbox class="flex items-center" [color]="'primary'"
                                        [formControlName]="'editor_et_al'">
                                        et al
                                    </mat-checkbox>
                                </ng-container>
                                
                            </ng-container>
                            
                            <!-- Translators -->
                            <ng-container *ngIf="changedValue[i] && changedValue[i].reftype != ''">
                                <ng-container *ngIf="changedValue[i].reftype == 'Book' || changedValue[i].reftype == 'Conference'">
                                    <div class="w-full space-y-2" formArrayName="translators">
                                        <span class="font-semibold">Translators</span>
                                        <div class="w-full h-full border-2 rounded-lg space-y-2 p-3 drag" cdkDropList
                                            [cdkDropListData]=getTranslators(data) (cdkDropListDropped)="drop($event)">
                                            <div class="border flex  space-x-2  items-center" [formGroupName]="j"
                                                *ngFor="let auth of getTranslators(data); let j = index" cdkDrag
                                                [cdkDragLockAxis]="'y'">
        
                                                <button mat-icon-button class="cursor-move" cdkDragHandle>
                                                    <mat-icon class="text-current" [svgIcon]="'heroicons_outline:menu'">
                                                    </mat-icon>
                                                </button>
                                                <div class="w-full -mt-4">
                                                    <mat-label>Surname</mat-label>
                                                    <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                         [config]="editorConfig"
                                                        [formControlName]="'surname'">
                                                    </ckeditor>
                                                </div>
                                                <div class="w-full -mt-4">
                                                    <mat-label>Given Name</mat-label>
                                                    <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                         [config]="editorConfig"
                                                        [formControlName]="'givenName'">
                                                    </ckeditor>
                                                </div>
                                                <div class="w-full -mt-4">
                                                    <mat-label>Prefix</mat-label>
                                                    <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                         [config]="editorConfig"
                                                        [formControlName]="'prefix'">
                                                    </ckeditor>
                                                </div>
                                                <div class="w-full -mt-4">
                                                    <mat-label>Suffix</mat-label>
                                                    <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                         [config]="editorConfig"
                                                        [formControlName]="'suffix'">
                                                    </ckeditor>
                                                </div>
                                                <div>
                                                    <button mat-icon-button (click)="addAuthorsItem(i, 'translators')">
                                                        <mat-icon class="text-current" [svgIcon]="'heroicons_outline:plus'">
                                                        </mat-icon>
                                                    </button>
        
                                                    <button mat-icon-button (click)="clearAuthorsItem(i,j, 'translators')">
                                                        <mat-icon class="text-current" [svgIcon]="'heroicons_outline:minus-sm'">
                                                        </mat-icon>
                                                    </button>
                                                </div>
        
                                            </div>
                                        </div>
        
                                    </div>
                                    <mat-checkbox class="flex items-center" [color]="'primary'"
                                        [formControlName]="'translator_et_al'">
                                        et al
                                    </mat-checkbox>
                                </ng-container>
                                
                            </ng-container>
                            
                            <!-- Input Form for selected reference Journal -->
                            <ng-container *ngIf="changedValue">
                                <ng-container *ngIf="changedValue[i].reftype == 'Journal'">
                                    <div class="flex w-full space-x-2">
                                        <div class="w-1/2 ">
                                            <mat-label>Article</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'article'">
                                            </ckeditor>
                                        </div>
                                        <div class="w-1/2 ">
                                            <mat-label>Source</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'source'">
                                            </ckeditor>
                                        </div>
                                    </div>
                                    <div class="flex w-full space-x-2">
                                        <div class="w-1/5">
                                            <mat-label>Year</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'year'">
                                            </ckeditor>
                                        </div>
                                        <div class="w-1/5">
                                            <mat-label>Volume</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'volume'">
                                            </ckeditor>
                                        </div>
                                        <div class="w-1/5">
                                            <mat-label>Issue</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'issue'">
                                            </ckeditor>
                                        </div>
                                        <div class="w-1/5">
                                            <mat-label>F_Page</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'f_page'">
                                            </ckeditor>
                                        </div>
                                        <div class="w-1/5">
                                            <mat-label>L_page</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'l_page'">
                                            </ckeditor>
                                        </div>
                                    </div>
                                    <div class="flex w-full">
                                        <div class="w-full">
                                            <mat-label>Comment</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'comment'">
                                            </ckeditor>
                                        </div>
                                    </div>
                                    <div class="flex w-full">
                                        <div class="w-full">
                                            <mat-label>DOI</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'doi'">
                                            </ckeditor>
                                        </div>
                                    </div>
                                    <div class="flex w-full">
                                        <div class="w-full">
                                            <mat-label>URI</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'uri'">
                                            </ckeditor>
                                        </div>
                                    </div>
                                    <div class="flex w-full space-x-2">
                                        <div class="w-1/2">
                                            <mat-label>Email</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'email'">
                                            </ckeditor>
                                        </div>
                                        <div class="flex w-1/2 space-x-2">
                                            <div class="w-1/3">
                                                <mat-label>Season</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor"
                                                    (focus)="focus($event)" 
                                                    [config]="editorConfig" [formControlName]="'season'">
                                                </ckeditor>
                                            </div>
                                            <div class="w-1/3">
                                                <mat-label>Month</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor"
                                                    (focus)="focus($event)" 
                                                    [config]="editorConfig" [formControlName]="'month'">
                                                </ckeditor>
                                            </div>
                                            <div class="w-1/3">
                                                <mat-label>Day</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor"
                                                    (focus)="focus($event)" 
                                                    [config]="editorConfig" [formControlName]="'day'">
                                                </ckeditor>
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>
                            </ng-container>

                            <!-- Input Form for selected reference Book -->
                            <ng-container *ngIf="changedValue">
                                <ng-container *ngIf="changedValue[i].reftype == 'Book'">
                                    <div class="flex w-full space-x-2">
                                        <div class="w-1/2 ">
                                            <mat-label>Chapter Title</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'article'">
                                            </ckeditor>
                                        </div>
                                        <div class="w-1/2 ">
                                            <mat-label>Source</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'source'">
                                            </ckeditor>
                                        </div>
                                    </div>
                                    <div class="flex w-full space-x-2">
                                        <div class="w-1/5">
                                            <mat-label>Volume</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'volume'">
                                            </ckeditor>
                                        </div>
                                        <div class="w-1/5">
                                            <mat-label>Series</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'series'">
                                            </ckeditor>
                                        </div>
                                        <div class="w-1/5">
                                            <mat-label>Edition</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'edition'">
                                            </ckeditor>
                                        </div>
                                        <div class="w-1/5">
                                            <mat-label>F_Page</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'f_page'">
                                            </ckeditor>
                                        </div>
                                        <div class="w-1/5">
                                            <mat-label>L_page</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'l_page'">
                                            </ckeditor>
                                        </div>
                                    </div>
                                    <div class="flex w-full space-x-2">
                                        <div class="w-1/2">
                                            <mat-label>Publisher Name</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor"
                                                (focus)="focus($event)" 
                                                [config]="editorConfig" [formControlName]="'publisherName'">
                                            </ckeditor>
                                        </div>
                                        <div class="w-1/2">
                                            <mat-label>Publisher Location</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor"
                                                (focus)="focus($event)" 
                                                [config]="editorConfig" [formControlName]="'publisherLocation'">
                                            </ckeditor>
                                        </div>
                                    </div>
                                    <div class="flex w-full">
                                        <div class="w-full">
                                            <mat-label>Comment</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'comment'">
                                            </ckeditor>
                                        </div>
                                    </div>
                                 
                                    <div class="flex w-full space-x-2">
                                        <div class="flex w-1/2 space-x-2">
                                            <div class="w-1/3">
                                                <mat-label>Month</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor"
                                                    (focus)="focus($event)" 
                                                    [config]="editorConfig" [formControlName]="'month'">
                                                </ckeditor>
                                            </div>
                                            <div class="w-1/3">
                                                <mat-label>Day</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor"
                                                    (focus)="focus($event)" 
                                                    [config]="editorConfig" [formControlName]="'day'">
                                                </ckeditor>
                                            </div>
                                            <div class="w-1/3">
                                                <mat-label>Year</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                     [config]="editorConfig"
                                                    [formControlName]="'year'">
                                                </ckeditor>
                                            </div>
                                            
                                        </div>
                                    </div>
                                </ng-container>
                            </ng-container>

                            <!-- Input Form for selected reference Conference -->
                            <ng-container *ngIf="changedValue">
                                <ng-container *ngIf="changedValue[i].reftype == 'Conference'">
                                    <div class="flex flex-col w-full space-y-2">
                                        <div>
                                            <mat-label>Conference Name</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'conferenceName'">
                                            </ckeditor>
                                        </div>
                                        <div>
                                            <mat-label>Conference Location</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'conferenceLocation'">
                                            </ckeditor>
                                        </div>
                                        <div class="w-1/5">
                                            <mat-label>Conference Date</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'conferenceDate'">
                                            </ckeditor>
                                        </div>
                                        <div>
                                            <mat-label>Conference Sponser</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'conferenceSponser'">
                                            </ckeditor>
                                        </div>
                                        <div >
                                            <mat-label>Comment</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'comment'">
                                            </ckeditor>
                                        </div>
                                        <div>
                                            <mat-label>Part Title</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'partTitle'">
                                            </ckeditor>
                                        </div>
                                        <div class="flex w-full space-x-2">
                                            <div class="w-1/2">
                                                <mat-label>Publisher Name</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor"
                                                    (focus)="focus($event)" 
                                                    [config]="editorConfig" [formControlName]="'publisherName'">
                                                </ckeditor>
                                            </div>
                                            <div class="w-1/2">
                                                <mat-label>Publisher Location</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor"
                                                    (focus)="focus($event)" 
                                                    [config]="editorConfig" [formControlName]="'publisherLocation'">
                                                </ckeditor>
                                            </div>
                                        </div>
                                        <div class="flex w-full space-x-2">
                                            <div class="w-1/5">
                                                <mat-label>Month</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor"
                                                    (focus)="focus($event)" 
                                                    [config]="editorConfig" [formControlName]="'month'">
                                                </ckeditor>
                                            </div>
                                            <div class="w-1/5">
                                                <mat-label>Day</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor"
                                                    (focus)="focus($event)" 
                                                    [config]="editorConfig" [formControlName]="'day'">
                                                </ckeditor>
                                            </div>
                                            <div class="w-1/5">
                                                <mat-label>Year</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                     [config]="editorConfig"
                                                    [formControlName]="'year'">
                                                </ckeditor>
                                            </div>
                                            <div class="w-1/5">
                                                <mat-label>F_Page</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                     [config]="editorConfig"
                                                    [formControlName]="'f_page'">
                                                </ckeditor>
                                            </div>
                                            <div class="w-1/5">
                                                <mat-label>L_page</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                     [config]="editorConfig"
                                                    [formControlName]="'l_page'">
                                                </ckeditor>
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>
                            </ng-container>

                            <!-- Input Form for selected reference Discussion -->
                            <ng-container *ngIf="changedValue">
                                <ng-container *ngIf="changedValue[i].reftype == 'Discussion'">
                                    <div class="flex flex-col w-full space-y-2">
                                        <div>
                                            <mat-label>Article</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'article'">
                                            </ckeditor>
                                        </div>
                                        <div>
                                            <mat-label>Comment</mat-label>
                                            <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                 [config]="editorConfig"
                                                [formControlName]="'comment'">
                                            </ckeditor>
                                        </div>

                                        <div class="flex space-x-2">
                                            <div class="w-2/5">
                                                <mat-label>Year</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor" (focus)="focus($event)"
                                                     [config]="editorConfig"
                                                    [formControlName]="'year'">
                                                </ckeditor>
                                            </div>
                                            <div class="w-2/5">
                                                <mat-label>Month</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor"
                                                    (focus)="focus($event)" 
                                                    [config]="editorConfig" [formControlName]="'month'">
                                                </ckeditor>
                                            </div>
                                            <div class="w-2/5">
                                                <mat-label>Day</mat-label>
                                                <ckeditor matInput class="w-full" [editor]="Editor"
                                                    (focus)="focus($event)" 
                                                    [config]="editorConfig" [formControlName]="'day'">
                                                </ckeditor>
                                            </div>
                                            
                                        </div>
                                        
                                    </div>
                                   
                                </ng-container>
                            </ng-container>
                        </div>
                    </mat-step>
                </mat-horizontal-stepper>
            </div>

            <!-- DOI -->
            <div class="flex w-full" *ngIf="referenceForm.get('refItems').value == 'doi'">
                <mat-form-field class="w-full">
                    <mat-label>DOI</mat-label>
                    <input [formControlName]="'doi'" placeholder="DOI" matInput autocomplete="off">
                </mat-form-field>
            </div>
            <!-- Pubmed -->
            <div class="flex w-full" *ngIf="referenceForm.get('refItems').value == 'pubmed'">
                <mat-form-field class="w-full">
                    <mat-label>Pubmed Id</mat-label>
                    <input [formControlName]="'pubmed_Id'" placeholder="Pubmed Id" matInput autocomplete="off">
                </mat-form-field>
            </div>
            <!--Text -->
            <div class="flex w-full" *ngIf="referenceForm.get('refItems').value == 'text'">
                <mat-form-field class="w-full">
                    <mat-label>Text</mat-label>
                    <input [formControlName]="'text'" placeholder="Text" matInput autocomplete="off">
                </mat-form-field>
            </div>
        </div>
    </form>

    <!-- Footer -->
    <div class="flex  bottom-0 items-center w-full border-t justify-end h-12  px-4  bg-gray-50 ">
        <button class="ml-2" mat-flat-button [color]="'primary'" [matTooltip]="'Submit'" (click)="refSubmit()">
            Submit
        </button>
    </div>
</div>